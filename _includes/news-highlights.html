{% comment %} Reads _data/news_highlights.yml {% endcomment %}
{% assign highlights = site.data.news_highlights | slice: 0, 3 %}
{% assign title  = include.title  | default: "Featured Stories" %}
{% assign kicker = include.kicker | default: "Top picks from Team Macuga" %}

<section class="news-highlights">
  <header class="section-head">
    <p class="section-kicker">{{ kicker }}</p>
    <h2 class="section-heading">{{ title }}</h2>
  </header>

  {% if highlights and highlights.size > 0 %}
    <div class="news-grid">
      {% for n in highlights %}
        <a class="news-card tall" href="{{ n.link }}" target="_blank" rel="noopener">
          <div class="news-eyebrow">
            <span class="source-pill">{{ n.source | default: "Featured" }}</span>

            {% if n.date %}
              {% assign day_num = n.date | date: "%-d" | plus: 0 %}
              {% if day_num == 11 or day_num == 12 or day_num == 13 %}
                {% assign suf = "th" %}
              {% else %}
                {% assign ones = day_num | modulo: 10 %}
                {% case ones %}
                  {% when 1 %}{% assign suf = "st" %}
                  {% when 2 %}{% assign suf = "nd" %}
                  {% when 3 %}{% assign suf = "rd" %}
                  {% else %}{% assign suf = "th" %}
                {% endcase %}
              {% endif %}
              <time class="news-date" datetime="{{ n.date }}">
                {{ n.date | date: "%B" }} {{ day_num }}{{ suf }}, {{ n.date | date: "%Y" }}
              </time>
            {% endif %}
          </div>

          <h3 class="news-title">{{ n.title }}</h3>
          {% if n.summary %}<p class="summary">{{ n.summary }}</p>{% endif %}

          {% if n.image %}
            {%- comment -%}
              Accepts either:
              - full path like "/assets/img/news/ap-highlight.webp"
              - or bare filename like "news/ap-highlight.webp"
              We normalize to a path relative to /assets/img/ or /assets/img_src/.
            {%- endcomment -%}
            {% assign img_rel = n.image
                | remove: '/assets/img/'
                | remove: '/assets/img_src/'
                | remove_first: '/' %}

            {% include picture.html
              src=img_rel
              alt=n.title
              widths="480,768,1100,1600"
              sizes="(min-width:960px) 50vw, 100vw"
              class="news-thumb-pic" %}
          {% endif %}
        </a>
      {% endfor %}
    </div>
  {% else %}
    <p class="muted">Add three stories to <code>_data/news_highlights.yml</code> to show highlights.</p>
  {% endif %}
</section>
