<!doctype html>
<html lang="en">
<head>
  {% include head.html %}

  <style>
    :root{
      --bg-logo-url: url('{{ "/assets/img/logo-full-color.png" | relative_url }}');
    }

    /* keeps logo fixed behind everything */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      background: var(--bg-logo-url) no-repeat center center;
      background-size: min(80vw, 840px);
      opacity: .085;
      filter: blur(1.5px);
      z-index: 0;
      pointer-events: none;
    }

    /* ensure page content sits above the fixed bg logo */
    .site-wrapper, main, header, footer { position: relative; z-index: 1; }
  </style>
</head>

<body>
  <div class="site-wrapper">
    {% include nav.html %}

    <main id="content">
      {{ content }}
    </main>

    <div class="sep"></div>
    {% include contact-strip.html %}

    <footer class="container">
      Â© {{ "now" | date: "%Y" }} Team Macuga. All rights reserved.
    </footer>
  </div>

  <!-- scripts (keep at end of body) -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // Tiny rotator for .carousel (bios)
    document.querySelectorAll('.carousel').forEach(car=>{
      const slides=[...car.querySelectorAll('.slide')];
      const dots=[...car.querySelectorAll('.dots button')];
      let i=0; const show=n=>{
        slides.forEach((s,k)=>s.classList.toggle('active',k===n));
        dots.forEach((d,k)=>d.classList.toggle('active',k===n));
        i=n;
      };
      dots.forEach((d,idx)=>d.addEventListener('click',()=>show(idx)));
      if(slides.length>1) setInterval(()=>show((i+1)%slides.length), 4500);
    });

    // Shop filters/sort (if present)
    const grid = document.getElementById('products');
    if(grid){
      const chips = document.querySelectorAll('.shop-controls .chip');
      const sortSel = document.getElementById('sortPrice');
      const filter = cat => document.querySelectorAll('.product-card')
        .forEach(c => c.classList.toggle('hide', !(cat==='all'||(c.dataset.cat||'').includes(cat))));
      chips.forEach(ch => ch.addEventListener('click', ()=>{
        chips.forEach(c=>c.removeAttribute('class')); 
        ch.classList.add('chip','active');
        filter(ch.dataset.filter);
      }));
      sortSel?.addEventListener('change', ()=>{
        const cards=[...document.querySelectorAll('.product-card')];
        if(sortSel.value!=='default'){
          const dir = sortSel.value==='asc'?1:-1;
          cards.sort((a,b)=>(parseFloat(a.dataset.price)-parseFloat(b.dataset.price))*dir);
        }
        cards.forEach(c=>grid.appendChild(c));
      });
    }
  });
  </script>

  <script defer src="{{ '/assets/js/carousel.js' | relative_url }}"></script>

  <script>
  (function(){
    const blocks = document.querySelectorAll('.mini-rotator');
    blocks.forEach(block => {
      const slides = Array.from(block.querySelectorAll('.slide'));
      if (slides.length < 2) return;

      // dots
      const dotsWrap = block.querySelector('.dots');
      slides.forEach((_, i) => {
        const b = document.createElement('button');
        b.addEventListener('click', () => go(i));
        dotsWrap.appendChild(b);
      });

      let idx = 0, timer;
      const dots = dotsWrap.querySelectorAll('button');

      function go(n){
        slides[idx].classList.remove('active');
        dots[idx].classList.remove('active');
        idx = (n + slides.length) % slides.length;
        slides[idx].classList.add('active');
        dots[idx].classList.add('active');
      }
      function start(){ timer = setInterval(() => go(idx+1), 3500); }
      function stop(){ clearInterval(timer); }

      go(0); start();
      block.addEventListener('mouseenter', stop);
      block.addEventListener('mouseleave', start);
    });
  })();
  </script>
</body>
</html>
